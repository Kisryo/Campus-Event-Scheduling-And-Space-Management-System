{% extends 'student/base_student.html' %}

{% block title %}Clubs & Societies | MMUEvent{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}">
{% endblock %}

{% block content %}

<div class="main-content-wrapper">
  
  <div class="header-section">
    <h1>Clubs & Societies</h1>
    <p>Browse active clubs and view their upcoming events.</p>
  </div>

  {# UPDATED: Check .items length or total count #}
  {% if organizers.items|length == 0 %}
      <div class="no-events-box">
          <h2>No active clubs found.</h2>
          <p>Check back later for updates!</p>
      </div>
  {% else %}
      
      <div class="event-grid-container">
        {# UPDATED: Loop through 'organizers.items' instead of 'organizers' #}
        {% for org in organizers.items %}
        <div class="event-card shadow-sm" style="display: flex; flex-direction: column; justify-content: center;">
            
            <div class="event-details text-center" style="padding: 40px 20px;">
                <h3 class="event-title mb-1" style="font-size: 1.5rem;">{{ org.organizer_name }}</h3>
                
                <p class="text-primary font-weight-bold mb-2" style="font-size: 0.9rem;">
                    ID: {{ org.organizer_id }}
                </p>

                <div style="margin-bottom: 30px; font-size: 0.95rem; color: #555;">
                    <p class="mb-2">
                        <i class="fas fa-envelope text-primary mr-2"></i> {{ org.organizer_email }}
                    </p>
                    {% if org.organizer_phone %}
                    <p class="mb-0">
                        <i class="fas fa-phone text-primary mr-2"></i> {{ org.organizer_phone }}
                    </p>
                    {% endif %}
                </div>
                
                <a href="{{ url_for('student_view.view_club_events', organizer_id=org.organizer_id) }}" class="view-details-btn">
                    View Events
                </a>
            </div>
        </div>
        {% endfor %}
      </div>  

      <div class="pagination">
        {% if organizers.has_prev %}
            <li>
                <a href="{{ url_for('student_view.organizers', page=organizers.prev_num, search=request.args.get('search', '')) }}">&laquo; Prev</a>
            </li>
        {% endif %}
        
        {% for page_num in organizers.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
            {% if page_num %}
                {% if organizers.page == page_num %}
                    <li class="active"><a href="#">{{ page_num }}</a></li>
                {% else %}
                    <li>
                        <a href="{{ url_for('student_view.organizers', page=page_num, search=request.args.get('search', '')) }}">{{ page_num }}</a>
                    </li>
                {% endif %}
            {% else %}
                <li><span>...</span></li>
            {% endif %}
        {% endfor %}
        
        {% if organizers.has_next %}
            <li>
                <a href="{{ url_for('student_view.organizers', page=organizers.next_num, search=request.args.get('search', '')) }}">Next &raquo;</a>
            </li>
        {% endif %}
      </div>

  {% endif %}

</div>

{% endblock %}
